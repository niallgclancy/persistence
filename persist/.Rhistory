temps=rbind(temps,temps2.barriers)
temps=rbind(temps, temps3.barriers)
temps$size_f = factor(temps$Size, levels=c("Small","Medium","Large"))
temps.barriers=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Downstream Barrier")+
theme(legend.title = element_text(size = 8))
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Downstream Barrier")+
theme(legend.title = element_text(size = 8))
temps.fragments
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Fragment Length")+
theme(legend.title = element_text(size = 8))
temps.fragments
temps.barriers
temps.barriers=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(DSbarrier)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Downstream Barrier")+
theme(legend.title = element_text(size = 8))
temps.barriers
#----------Barrier---------------------------------------------------------
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps=as.data.frame(S1_93_11)
temps$F_MAUG_HIS=NA
temps$F_MAUG_HIS=7.238985
temps$DSbarrier=NA
temps$DSbarrier=0
temps$Length_km=NA
temps$Length_km=median(obsrelict$Length_km)
temps$nnPreds=NA
temps$nnPreds=0
temps$Yrange=NA
temps$Yrange=max(obsrelict$Yrange)
temps$persSmGlacial=NA
temps$persSmGlacial=predict(nsGlacial, temps)
temps$Size=NA
temps$Size="Small"
temps1=temps
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2=as.data.frame(S1_93_11)
temps2$F_MAUG_HIS=NA
temps2$F_MAUG_HIS=97.94914
temps2$DSbarrier=NA
temps2$DSbarrier=0
temps2$Length_km=NA
temps2$Length_km=median(obsrelict$Length_km)
temps2$nnPreds=NA
temps2$nnPreds=0
temps2$Yrange=NA
temps2$Yrange=max(obsrelict$Yrange)
temps2$persSmGlacial=NA
temps2$persSmGlacial=predict(nsGlacial, temps2)
temps2$Size=NA
temps2$Size="Medium"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3=as.data.frame(S1_93_11)
temps3$F_MAUG_HIS=NA
temps3$F_MAUG_HIS=858.207
temps3$DSbarrier=NA
temps3$DSbarrier=0
temps3$Length_km=NA
temps3$Length_km=median(obsrelict$Length_km)
temps3$nnPreds=NA
temps3$nnPreds=0
temps3$Yrange=NA
temps3$Yrange=max(obsrelict$Yrange)
temps3$persSmGlacial=NA
temps3$persSmGlacial=predict(nsGlacial, temps3)
temps3$Size=NA
temps3$Size="Large"
###############
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps1.barriers=as.data.frame(S1_93_11)
temps1.barriers$F_MAUG_HIS=NA
temps1.barriers$F_MAUG_HIS=7.238985
temps1.barriers$DSbarrier=NA
temps1.barriers$DSbarrier=1
temps1.barriers$Length_km=NA
temps1.barriers$Length_km=median(obsrelict$Length_km)
temps1.barriers$nnPreds=NA
temps1.barriers$nnPreds=0
temps1.barriers$Yrange=NA
temps1.barriers$Yrange=max(obsrelict$Yrange)
temps1.barriers$persSmGlacial=NA
temps1.barriers$persSmGlacial=predict(nsGlacial, temps1.barriers)
temps1.barriers$Size=NA
temps1.barriers$Size="Small"
temps1.barriers=temps1.barriers
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2.barriers=as.data.frame(S1_93_11)
temps2.barriers$F_MAUG_HIS=NA
temps2.barriers$F_MAUG_HIS=97.94914
temps2.barriers$DSbarrier=NA
temps2.barriers$DSbarrier=1
temps2.barriers$Length_km=NA
temps2.barriers$Length_km=median(obsrelict$Length_km)
temps2.barriers$nnPreds=NA
temps2.barriers$nnPreds=0
temps2.barriers$Yrange=NA
temps2.barriers$Yrange=max(obsrelict$Yrange)
temps2.barriers$persSmGlacial=NA
temps2.barriers$persSmGlacial=predict(nsGlacial, temps2.barriers)
temps2.barriers$Size=NA
temps2.barriers$Size="Medium"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3.barriers=as.data.frame(S1_93_11)
temps3.barriers$F_MAUG_HIS=NA
temps3.barriers$F_MAUG_HIS=858.207
temps3.barriers$DSbarrier=NA
temps3.barriers$DSbarrier=1
temps3.barriers$Length_km=NA
temps3.barriers$Length_km=median(obsrelict$Length_km)
temps3.barriers$nnPreds=NA
temps3.barriers$nnPreds=0
temps3.barriers$Yrange=NA
temps3.barriers$Yrange=max(obsrelict$Yrange)
temps3.barriers$persSmGlacial=NA
temps3.barriers$persSmGlacial=predict(nsGlacial, temps3.barriers)
temps3.barriers$Size=NA
temps3.barriers$Size="Large"
###############
temps=rbind(temps1,temps2)
temps=rbind(temps, temps3)
temps=rbind(temps,temps1.barriers)
temps=rbind(temps,temps2.barriers)
temps=rbind(temps, temps3.barriers)
temps$size_f = factor(temps$Size, levels=c("Small","Medium","Large"))
temps$DSbarrier[which(temps$DSbarrier==1)]="Yes"
temps$DSbarrier[which(temps$DSbarrier==0)]="No"
temps.barriers=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(DSbarrier)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Downstream Barrier")+
theme(legend.title = element_text(size = 8))
temps.barriers
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Fragment Length")+
theme(legend.title = element_text(size = 8))
temps.fragments
plot(density(log(obsrelict$Length_km)))
median(log(obsrelict$Length_km))
obsrelict2=subset(obsrelict,obsrelict$Length_km<68.21101)
median(obsrelict2$Length_km)#30.423
obsrelict2=subset(obsrelict,obsrelict$Length_km>=68.21101)
median(obsrelict2$Length_km)#128.81
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps=as.data.frame(S1_93_11)
temps$F_MAUG_HIS=NA
temps$F_MAUG_HIS=7.238985
temps$DSbarrier=NA
temps$DSbarrier=0
temps$Length_km=NA
temps$Length_km=30.423
temps$nnPreds=NA
temps$nnPreds=0
temps$Yrange=NA
temps$Yrange=max(obsrelict$Yrange)
temps$persSmGlacial=NA
temps$persSmGlacial=predict(nsGlacial, temps)
temps$Size=NA
temps$Size="Small"
temps$Fragment=NA
temps$Fragment="Small"
temps1=temps
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2=as.data.frame(S1_93_11)
temps2$F_MAUG_HIS=NA
temps2$F_MAUG_HIS=97.94914
temps2$DSbarrier=NA
temps2$DSbarrier=0
temps2$Length_km=NA
temps2$Length_km=30.423
temps2$nnPreds=NA
temps2$nnPreds=0
temps2$Yrange=NA
temps2$Yrange=max(obsrelict$Yrange)
temps2$persSmGlacial=NA
temps2$persSmGlacial=predict(nsGlacial, temps2)
temps2$Size=NA
temps2$Size="Medium"
temps2$Fragment=NA
temps2$Fragment="Small"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3=as.data.frame(S1_93_11)
temps3$F_MAUG_HIS=NA
temps3$F_MAUG_HIS=858.207
temps3$DSbarrier=NA
temps3$DSbarrier=0
temps3$Length_km=NA
temps3$Length_km=30.423
temps3$nnPreds=NA
temps3$nnPreds=0
temps3$Yrange=NA
temps3$Yrange=max(obsrelict$Yrange)
temps3$persSmGlacial=NA
temps3$persSmGlacial=predict(nsGlacial, temps3)
temps3$Size=NA
temps3$Size="Large"
temps3$Fragment=NA
temps3$Fragment="Small"
###############
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps1.barriers=as.data.frame(S1_93_11)
temps1.barriers$F_MAUG_HIS=NA
temps1.barriers$F_MAUG_HIS=7.238985
temps1.barriers$DSbarrier=NA
temps1.barriers$DSbarrier=0
temps1.barriers$Length_km=NA
temps1.barriers$Length_km=128.81
temps1.barriers$nnPreds=NA
temps1.barriers$nnPreds=0
temps1.barriers$Yrange=NA
temps1.barriers$Yrange=max(obsrelict$Yrange)
temps1.barriers$persSmGlacial=NA
temps1.barriers$persSmGlacial=predict(nsGlacial, temps1.barriers)
temps1.barriers$Size=NA
temps1.barriers$Size="Small"
temps1.barriers=temps1.barriers
temps1.barriers$Fragment=NA
temps1.barriers$Fragment="Large"
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2.barriers=as.data.frame(S1_93_11)
temps2.barriers$F_MAUG_HIS=NA
temps2.barriers$F_MAUG_HIS=97.94914
temps2.barriers$DSbarrier=NA
temps2.barriers$DSbarrier=0
temps2.barriers$Length_km=NA
temps2.barriers$Length_km=128.81
temps2.barriers$nnPreds=NA
temps2.barriers$nnPreds=0
temps2.barriers$Yrange=NA
temps2.barriers$Yrange=max(obsrelict$Yrange)
temps2.barriers$persSmGlacial=NA
temps2.barriers$persSmGlacial=predict(nsGlacial, temps2.barriers)
temps2.barriers$Size=NA
temps2.barriers$Size="Medium"
temps2.barriers$Fragment=NA
temps2.barriers$Fragment="Large"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3.barriers=as.data.frame(S1_93_11)
temps3.barriers$F_MAUG_HIS=NA
temps3.barriers$F_MAUG_HIS=858.207
temps3.barriers$DSbarrier=NA
temps3.barriers$DSbarrier=0
temps3.barriers$Length_km=NA
temps3.barriers$Length_km=128.81
temps3.barriers$nnPreds=NA
temps3.barriers$nnPreds=0
temps3.barriers$Yrange=NA
temps3.barriers$Yrange=max(obsrelict$Yrange)
temps3.barriers$persSmGlacial=NA
temps3.barriers$persSmGlacial=predict(nsGlacial, temps3.barriers)
temps3.barriers$Size=NA
temps3.barriers$Size="Large"
temps3.barriers$Fragment=NA
temps3.barriers$Fragment="Large"
#Merge
temps=rbind(temps1,temps2)
temps=rbind(temps, temps3)
temps=rbind(temps,temps1.barriers)
temps=rbind(temps,temps2.barriers)
temps=rbind(temps, temps3.barriers)
temps$size_f = factor(temps$Size, levels=c("Small","Medium","Large"))
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Fragment Length")+
theme(legend.title = element_text(size = 8))
temps.fragments
install.packages("ggpubr")
library(ggpubr)
ggarrange(temps.barriers,temps.fragments)
ggarrange(temps.barriers,temps.fragments,ncol=1)
plot(density(log(obsrelict$Length_km)))
median(log(obsrelict$Length_km))
obsrelict2=subset(obsrelict,obsrelict$Length_km<68.21101)
median(obsrelict2$Length_km)#30.423
obsrelict2=subset(obsrelict,obsrelict$Length_km>=68.21101)
median(obsrelict2$Length_km)#128.81
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps=as.data.frame(S1_93_11)
temps$F_MAUG_HIS=NA
temps$F_MAUG_HIS=7.238985
temps$DSbarrier=NA
temps$DSbarrier=0
temps$Length_km=NA
temps$Length_km=30.423
temps$nnPreds=NA
temps$nnPreds=0
temps$Yrange=NA
temps$Yrange=max(obsrelict$Yrange)
temps$persSmGlacial=NA
temps$persSmGlacial=predict(nsGlacial, temps)
temps$Size=NA
temps$Size="Small"
temps$Fragment=NA
temps$Fragment="Short"
temps1=temps
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2=as.data.frame(S1_93_11)
temps2$F_MAUG_HIS=NA
temps2$F_MAUG_HIS=97.94914
temps2$DSbarrier=NA
temps2$DSbarrier=0
temps2$Length_km=NA
temps2$Length_km=30.423
temps2$nnPreds=NA
temps2$nnPreds=0
temps2$Yrange=NA
temps2$Yrange=max(obsrelict$Yrange)
temps2$persSmGlacial=NA
temps2$persSmGlacial=predict(nsGlacial, temps2)
temps2$Size=NA
temps2$Size="Medium"
temps2$Fragment=NA
temps2$Fragment="Short"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3=as.data.frame(S1_93_11)
temps3$F_MAUG_HIS=NA
temps3$F_MAUG_HIS=858.207
temps3$DSbarrier=NA
temps3$DSbarrier=0
temps3$Length_km=NA
temps3$Length_km=30.423
temps3$nnPreds=NA
temps3$nnPreds=0
temps3$Yrange=NA
temps3$Yrange=max(obsrelict$Yrange)
temps3$persSmGlacial=NA
temps3$persSmGlacial=predict(nsGlacial, temps3)
temps3$Size=NA
temps3$Size="Large"
temps3$Fragment=NA
temps3$Fragment="Short"
###############
######SMALL STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps1.barriers=as.data.frame(S1_93_11)
temps1.barriers$F_MAUG_HIS=NA
temps1.barriers$F_MAUG_HIS=7.238985
temps1.barriers$DSbarrier=NA
temps1.barriers$DSbarrier=0
temps1.barriers$Length_km=NA
temps1.barriers$Length_km=128.81
temps1.barriers$nnPreds=NA
temps1.barriers$nnPreds=0
temps1.barriers$Yrange=NA
temps1.barriers$Yrange=max(obsrelict$Yrange)
temps1.barriers$persSmGlacial=NA
temps1.barriers$persSmGlacial=predict(nsGlacial, temps1.barriers)
temps1.barriers$Size=NA
temps1.barriers$Size="Small"
temps1.barriers=temps1.barriers
temps1.barriers$Fragment=NA
temps1.barriers$Fragment="Long"
######MEDIUM STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps2.barriers=as.data.frame(S1_93_11)
temps2.barriers$F_MAUG_HIS=NA
temps2.barriers$F_MAUG_HIS=97.94914
temps2.barriers$DSbarrier=NA
temps2.barriers$DSbarrier=0
temps2.barriers$Length_km=NA
temps2.barriers$Length_km=128.81
temps2.barriers$nnPreds=NA
temps2.barriers$nnPreds=0
temps2.barriers$Yrange=NA
temps2.barriers$Yrange=max(obsrelict$Yrange)
temps2.barriers$persSmGlacial=NA
temps2.barriers$persSmGlacial=predict(nsGlacial, temps2.barriers)
temps2.barriers$Size=NA
temps2.barriers$Size="Medium"
temps2.barriers$Fragment=NA
temps2.barriers$Fragment="Long"
######LARGE STREAMS
S1_93_11=seq(from=10, to=40, by=0.1)
temps3.barriers=as.data.frame(S1_93_11)
temps3.barriers$F_MAUG_HIS=NA
temps3.barriers$F_MAUG_HIS=858.207
temps3.barriers$DSbarrier=NA
temps3.barriers$DSbarrier=0
temps3.barriers$Length_km=NA
temps3.barriers$Length_km=128.81
temps3.barriers$nnPreds=NA
temps3.barriers$nnPreds=0
temps3.barriers$Yrange=NA
temps3.barriers$Yrange=max(obsrelict$Yrange)
temps3.barriers$persSmGlacial=NA
temps3.barriers$persSmGlacial=predict(nsGlacial, temps3.barriers)
temps3.barriers$Size=NA
temps3.barriers$Size="Large"
temps3.barriers$Fragment=NA
temps3.barriers$Fragment="Long"
#Merge
temps=rbind(temps1,temps2)
temps=rbind(temps, temps3)
temps=rbind(temps,temps1.barriers)
temps=rbind(temps,temps2.barriers)
temps=rbind(temps, temps3.barriers)
temps$size_f = factor(temps$Size, levels=c("Small","Medium","Large"))
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Fragment Length")+
theme(legend.title = element_text(size = 8))
temps.fragments
library(ggpubr)
ggarrange(temps.barriers,temps.fragments,ncol=1)
ggsave(filename = "GlacialRelictsPredicted.tiff",dpi=400, width = 10, height = 6, units = "in")
ggsave(filename = "GlacialRelictsPredicted.tiff",dpi=400, width = 10, height = 6, units = "in", title="FD")
ggarrange(temps.barriers,temps.fragments,ncol=1)
top = text_grob("Glacial Relict Persistence",  face = "bold", size = 14),
annotate_figure(figure,
top = text_grob("Glacial Relict Persistence", face = "bold", size = 14))
annotate_figure(figure,
top = text_grob("Glacial Relict Persistence", face = "bold", size = 14))
relicts.predicted=ggarrange(temps.barriers,temps.fragments,ncol=1)
annotate_figure(relicts.predicted,top = text_grob("Glacial Relict Persistence", face = "bold", size = 14))
annotate_figure(relicts.predicted,top = text_grob("Glacial-Relict Persistence", face = "bold", size = 14))
temps.fragments=temps%>%
ggplot(aes(x=S1_93_11,y=persSmGlacial, linetype = as.factor(Fragment)))+
geom_smooth(method = "lm", se=F, color="black")+
scale_y_continuous(limits = c(0,1))+
theme_classic()+
facet_wrap(~size_f)+
ylab(label="Proportion of Species Persisting")+
xlab(label = "Mean August Stream Temperature")+
labs(linetype = "Fragment  Length  ")+
theme(legend.title = element_text(size = 8))
temps.fragments
library(ggpubr)
relicts.predicted=ggarrange(temps.barriers,temps.fragments,ncol=1)
annotate_figure(relicts.predicted,top = text_grob("Glacial-Relict Persistence", face = "bold", size = 14))
ggsave(filename = "GlacialRelictsPredicted.tiff",dpi=400, width = 10, height = 6, units = "in")
coeff%>%arrange(Score2) %>%
mutate(Variable=factor(Variable, levels=Variable)) %>%
ggplot(aes(x=Variable, y=Score2)) +
geom_segment( aes(xend=Variable, y=0,yend=Score2)) +
geom_point( color="purple", size=4) +
theme_light() +
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank()
) +
xlab("") +
coord_flip() +
ylab("Variable Importance")
