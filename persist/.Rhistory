scale_color_manual(name="Fragment Length",values=c("black", "#B0B0B0"))+
geom_text(aes(x=12,y=0.66),label="Large", color="black")+
geom_text(aes(x=11,y=0.765),label="Small", color="#B0B0B0")+
ylab(label = "Native Species Persistence")+
xlab(label = "Stream Temperature (C)")+
ggtitle(label = "Persistence by Fragment Length & Temperature")+
theme_classic()+
theme(legend.position=c(0.27,0.25),
legend.box.background = element_rect(),
legend.box.margin = margin(5,5,5,5),
axis.title = element_text(size=12),
axis.text = element_text(size=10, color = "black"))
tempgraph
sizegraph=nssn$obs%>%
group_by(length,FragCat,TempCat, GNIS_NA)%>%
summarise(pNAT=mean(pNat))%>%
ggplot(aes(x=log(length), y=pNAT, color = TempCat))+
geom_jitter(size=2)+
stat_smooth(method = "glm", method.args = list(family=binomial), se=F, linewidth=1.5)+
scale_color_manual(name="Stream Temperature", values = c("dodgerblue","darkorange"))+
#geom_text(aes(x=20,y=0.64),label="Cold", color="lightblue")+
#geom_text(aes(x=17,y=0.43),label="Cool-Warm", color="firebrick3")+
ylab(label = "Native Species Persistence")+
xlab(label = "log(Fragment Length (km))")+
ggtitle(label = "C. Native Sp. Pers. by Fragment Length & Temp.")+
theme_classic()+
theme(
legend.position=c(0.19,0.17),
legend.background = element_blank(),
legend.box.margin = margin(2,2,2,2),
legend.key.size = unit(0.15, 'in'),
legend.title = element_text(face="bold"),
legend.key.spacing.y = unit(0.5,"pt"),
axis.title = element_text(size=12),
axis.text = element_text(size=10, color = "black"))
sizegraph
ggsave(filename = "Temp&Length.tiff", dpi=400, height = 4,, width = 5, units = "in")
nssn$obs$prosper
permgraph=nssn$obs%>%
group_by(prosper,TempCat, GNIS_NA)%>%
summarise(pNAT=mean(pNat))%>%
ggplot(aes(x=prosper, y=pNAT, color = TempCat))+
geom_jitter(size=2)+
stat_smooth(method = "glm", method.args = list(family=binomial), se=F, linewidth=1.5)+
scale_color_manual(name="Stream Temperature", values = c("dodgerblue","darkorange"))+
#geom_text(aes(x=20,y=0.64),label="Cold", color="lightblue")+
#geom_text(aes(x=17,y=0.43),label="Cool-Warm", color="firebrick3")+
ylab(label = "Native Species Persistence")+
xlab(label = "Probability of Flow Permanence")+
ggtitle(label = "D. Native Sp. Pers. by Flow Permanence & Temp.")+
theme_classic()+
theme(
legend.position=c(0.19,0.17),
legend.background = element_blank(),
legend.box.margin = margin(2,2,2,2),
legend.key.size = unit(0.15, 'in'),
legend.title = element_text(face="bold"),
legend.key.spacing.y = unit(0.5,"pt"),
axis.title = element_text(size=12),
axis.text = element_text(size=10, color = "black"))
permgraph
ggsave(filename = "Temp&PROSPER.tiff", dpi=400, height = 4,, width = 5, units = "in")
###
tempgraph2=nssn$obs%>%
group_by(temp, GNIS_NA)%>%
summarise(pNAT=mean(pNat))%>%
ggplot(aes(x=temp, y=pNAT))+
geom_point()+
stat_smooth(method = "glm", method.args = list(family=binomial), se=T, linewidth=1.5, color="black")+
ylab(label = "Native Species Persistence")+
xlab(label = "Stream Temperature (C)")+
ggtitle(label = "D. Persistence by Temperature")+
theme_classic()+
theme(legend.position="none",
axis.title = element_text(size=12),
axis.text = element_text(size=10, color = "black"))
tempgraph2
sizegraph2=nssn$obs%>%
group_by(length, GNIS_NA)%>%
summarise(pNAT=mean(pNat))%>%
ggplot(aes(x=length, y=pNAT))+
#geom_point()+
stat_smooth(method = "glm", method.args = list(family=binomial), linewidth=1.5, color="black")+
ylab(label = "Native Species Persistence")+
xlab(label = "Fragment Length (km)")+
ggtitle(label = "Persistence by Fragment Length")+
#ylim(limits=c(0.3,1))+
theme_classic()+
theme(axis.title = element_text(size=12),
axis.text = element_text(size=10, color = "black"))
sizegraph2
library(ggpubr)
VarImpComb=ggarrange(VarImpNative,VarImpTurn,
nrow = 2)
VarImpComb
ModComb=ggarrange(sizegraph,permgraph,nrow = 2)
ModComb
ggarrange(VarImpComb,ModComb, ncol = 2)
ggsave(filename = "VariableGraph2.tiff",dpi=400, height = 10, width = 10, units = "in")
#==================================================================================
#============================SECTION 4: SSN Models for Individual Species
#==================================================================================
obs3=obs
obs3$geometry=NULL
obs3=obs3%>%pivot_longer(cols=28:121, names_to = "Species")%>%
filter(!is.na(value))%>%
group_by(Species)%>%
summarise(sites=length(RepeatID))
#=====================================================================
#============================SECTION 5: Examine Net Change for Species
#=====================================================================
#---------------------Net Species Change------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="COLCOT"|NET$Species=="RMCOT")]="MOTCOT"
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change), sites=length(unique(RepeatID)))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
NET=left_join(NET,NET3,by="Species")
NET$EarlyNum[which(is.na(NET$EarlyNum))]=0
NET$LateNum[which(is.na(NET$LateNum))]=0
NET$propChange=NA
NET$propChange=NET$LateNum/NET$EarlyNum
NET=full_join(NET,traits,by="Species")
write.csv(NET,"NET2.csv")
NETsub=subset(NET,NET$sites>=20)
NETsub=subset(NETsub,NETsub$Species!="ONC" & NETsub$Species!="FMxWSU")
mean(NETsub$propChange)
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
traits$Species[which(traits$Species=="COLCOT")]="MOTCOT"
NETsub=left_join(NETsub,traits,by="Species")
NETsub$CommonName[which(NETsub$CommonName=="Northern Redbelly Dace")]="Nor. Redbelly Dace"
NETsub$CommonName[which(NETsub$CommonName=="Rocky Mountain Cutthroat Trout")]="R.M. Cutthroat Trout"
View(NET)
NETsub=subset(NET,NET$sites>=20)
NETsub=subset(NETsub,NETsub$Species!="ONC" & NETsub$Species!="FMxWSU")
mean(NETsub$propChange)
#traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
#traits=read.csv("traits.csv")
#traits=traits%>%rename("Species"="Code")
traits$Species[which(traits$Species=="COLCOT")]="MOTCOT"
#NETsub=left_join(NETsub,traits,by="Species")
NETsub$CommonName[which(NETsub$CommonName=="Northern Redbelly Dace")]="Nor. Redbelly Dace"
NETsub$CommonName[which(NETsub$CommonName=="Rocky Mountain Cutthroat Trout")]="R.M. Cutthroat Trout"
NETsub$Direc=NA
NETsub$Direc[which(NETsub$propChange>=1)]="Pos"
NETsub$Direc[which(NETsub$propChange<1)]="Neg"
NETsubALL=subset(NETsub,NETsub$Status=="Introduced")
changenative=NETsub%>%
ggplot(aes(x=reorder(CommonName,-propChange),y=propChange, colour = Direc))+
geom_segment( aes(x=CommonName, xend=CommonName, y=1, yend=propChange), color="black") +
geom_point(size=3)+
theme_light()+
ylab(label = "Percent Change in Sites Occupied")+
scale_y_continuous(breaks=seq(0.25,2.5,by=0.25), limits = c(0.25,2.5), labels = c("-75%","-50%","-25%","0%","+25%","+50%","+75%","+100%","+125%","+150%"))+
xlab(label="")+
scale_color_manual(values = c("#ff9999", "#018081"))+
coord_flip()+
theme(#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1,face = 2),
legend.title = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.text.y = element_text(size=12, color = "black"),
axis.text.x = element_text(size=10, color = "black"),
axis.ticks.x = element_blank(),
legend.position = "none")
changenative
ggsave(filename="NativeSpChange.tiff",dpi = 400, width = 8, height = 6, units = "in")
#---------------------Net Species Changes to Only Native Populations------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
NET$Status[which(NET$Species=="BLBH")]="Native"
NET$Status[which(NET$Species=="BLBH" & NET$RepeatID %in% BLBHnn)]="Introduced"
NET$Status[which(NET$Species=="CCAT" & NET$RepeatID %in% CCATnn)]="Introduced"
NET$Status[which(NET$Species=="LING" & NET$RepeatID %in% LINGnn)]="Introduced"
NET$Status[which(NET$Species=="WSU" & NET$RepeatID %in% WSUnn)]="Introduced"
NET$Status[which(NET$Species=="RMCT" & NET$RepeatID %in% RMCTnn)]="Introduced"
NET$Status[which(NET$Species=="DRUM")]="Native"
NET$Status[which(NET$Species=="DRUM" & NET$RepeatID %in% drumnn)]="Introduced"
NET$Status[which(NET$Species=="PKF")]="Native"
NET$Status[which(NET$Species=="PKF" & NET$RepeatID %in% pkfnn)]="Introduced"
NET$Status[which(NET$Species=="PTMN")]="Native"
NET$Status[which(NET$Species=="PTMN" & NET$RepeatID %in% ptmnnn)]="Introduced"
NET$Status[which(NET$Species=="BRSB")]="Native"
NET$Status[which(NET$Species=="BRSB" & NET$RepeatID %in% brsbnn)]="Introduced"
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
NET=subset(NET,NET$Status=="Native"|NET$Species%in%invasive20s)
nativeSites=NET%>%
group_by(Species)%>%
summarise(sites=length(RepeatID))
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
NET=left_join(NET,NET3,by="Species")
NET$EarlyNum[which(is.na(NET$EarlyNum))]=0
NET$LateNum[which(is.na(NET$LateNum))]=0
NET$propChange=NA
NET$propChange=NET$LateNum/NET$EarlyNum
NET=left_join(NET,nativeSites,by="Species")
NETsub=subset(NET,NET$sites>=20)
NETsub=subset(NETsub,NETsub$Species!="ONC" & NETsub$Species!="FMxWSU")
mean(NETsub$propChange)
write.csv(NETsub, "table1material.csv")
traits2=traits[,c(1,3)]
NETsub=left_join(NETsub,traits2,by="Species")
NETsub$CommonName[which(NETsub$CommonName=="Northern Redbelly Dace")]="Nor. Redbelly Dace"
NETsub$CommonName[which(NETsub$CommonName=="Rocky Mountain Cutthroat Trout")]="R.M. Cutthroat Trout"
NETsub$Direc=NA
NETsub$Direc[which(NETsub$propChange>=1)]="Pos"
NETsub$Direc[which(NETsub$propChange<1)]="Neg"
NETsub$Status=NA
NETsub$Status="Native"
NETsub$Status[which(NETsub$Species%in%invasive20s)]="Introduced"
NETsub$percChange=NA
NETsub$percChange=NETsub$propChange*100
NETsub$Status2=NA
NETsub$Status2="PGP"
NETsub$Status2[which(NETsub$Species=="LKCH"|NETsub$Species=="BRSB"|NETsub$Species=="PLSU"|NETsub$Species=="NRBDC"|NETsub$Species=="IOWA")]="GR"
NETsub$Status2[which(NETsub$Status=="Introduced")]="NN"
NETsub$Status2[which(NETsub$Species=="STR"|NETsub$Species=="CCAT"|NETsub$Species=="CMSH"|NETsub$Species=="CRCH"|NETsub$Species=="FMSU"|NETsub$Species=="JDT"|NETsub$Species=="PLMN"|NETsub$Species=="RCSU"|NETsub$Species=="RTCH"|NETsub$Species=="SDSH")]="OtherN"
library(ggbreak)
library(ggh4x)
changenative=NETsub%>%
ggplot(aes(x=reorder(CommonName,-propChange),y=propChange, shape = Status2, color=Status2))+
geom_hline(yintercept = 1, color=alpha("black", alpha = 0.3), linewidth=1.1)+
geom_segment( aes(x=CommonName, xend=CommonName, y=1, yend=propChange), color="black") +
geom_point(size=3)+
theme_light()+
ylab(label = "Occupancy Change")+
xlab(label="")+
scale_color_manual(values = c("lightblue", "#ff9999","lightgreen","dodgerblue4"))+
scale_shape_manual(values=c(15,17, 16, 15))+
scale_y_continuous(limits = c(0,6), breaks = seq(0,5.4, by=0.2),minor_breaks = seq(0,5.4,by=0.1),guide = "axis_minor")+
coord_flip()+
theme(#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1,face = 2),
legend.title = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
axis.text.y = element_text(size=12, color = "black"),
axis.text.x = element_text(size=10, color = "black"),
legend.position = "none")+
theme(ggh4x.axis.ticks.length.minor=rel(1))+
scale_y_break(c(2.5, 5))
changenative
ggsave(filename="NativeSpChange.tiff",dpi = 400, width = 10, height = 8, units = "in")
#---------------------Net Species Changes to Only Native Populations------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
NET$Status[which(NET$Species=="BLBH")]="Native"
NET$Status[which(NET$Species=="BLBH" & NET$RepeatID %in% BLBHnn)]="Introduced"
NET$Status[which(NET$Species=="CCAT" & NET$RepeatID %in% CCATnn)]="Introduced"
NET$Status[which(NET$Species=="LING" & NET$RepeatID %in% LINGnn)]="Introduced"
NET$Status[which(NET$Species=="WSU" & NET$RepeatID %in% WSUnn)]="Introduced"
NET$Status[which(NET$Species=="RMCT" & NET$RepeatID %in% RMCTnn)]="Introduced"
NET$Status[which(NET$Species=="DRUM")]="Native"
NET$Status[which(NET$Species=="DRUM" & NET$RepeatID %in% drumnn)]="Introduced"
NET$Status[which(NET$Species=="PKF")]="Native"
NET$Status[which(NET$Species=="PKF" & NET$RepeatID %in% pkfnn)]="Introduced"
NET$Status[which(NET$Species=="PTMN")]="Native"
NET$Status[which(NET$Species=="PTMN" & NET$RepeatID %in% ptmnnn)]="Introduced"
NET$Status[which(NET$Species=="BRSB")]="Native"
NET$Status[which(NET$Species=="BRSB" & NET$RepeatID %in% brsbnn)]="Introduced"
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
NET=subset(NET,NET$Status=="Native"|NET$Species%in%invasive20s)
nativeSites=NET%>%
group_by(Species)%>%
summarise(sites=length(RepeatID))
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
NET=left_join(NET,NET3,by="Species")
NET$EarlyNum[which(is.na(NET$EarlyNum))]=0
NET$LateNum[which(is.na(NET$LateNum))]=0
NET$propChange=NA
NET$propChange=NET$LateNum/NET$EarlyNum
NET=left_join(NET,nativeSites,by="Species")
View(NET)
NETl20=subset(NET,NET$sites<20)
View(NETl20)
#---------------------Net Species Changes to Only Native Populations------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
NET$Status[which(NET$Species=="BLBH")]="Native"
NET$Status[which(NET$Species=="BLBH" & NET$RepeatID %in% BLBHnn)]="Introduced"
NET$Status[which(NET$Species=="CCAT" & NET$RepeatID %in% CCATnn)]="Introduced"
NET$Status[which(NET$Species=="LING" & NET$RepeatID %in% LINGnn)]="Introduced"
NET$Status[which(NET$Species=="WSU" & NET$RepeatID %in% WSUnn)]="Introduced"
NET$Status[which(NET$Species=="RMCT" & NET$RepeatID %in% RMCTnn)]="Introduced"
NET$Status[which(NET$Species=="DRUM")]="Native"
NET$Status[which(NET$Species=="DRUM" & NET$RepeatID %in% drumnn)]="Introduced"
NET$Status[which(NET$Species=="PKF")]="Native"
NET$Status[which(NET$Species=="PKF" & NET$RepeatID %in% pkfnn)]="Introduced"
NET$Status[which(NET$Species=="PTMN")]="Native"
NET$Status[which(NET$Species=="PTMN" & NET$RepeatID %in% ptmnnn)]="Introduced"
NET$Status[which(NET$Species=="BRSB")]="Native"
NET$Status[which(NET$Species=="BRSB" & NET$RepeatID %in% brsbnn)]="Introduced"
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
NET=subset(NET,NET$Status=="Native"|NET$Species%in%invasive20s)
#---------------------Net Species Changes to Only Native Populations------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
NET$Status[which(NET$Species=="BLBH")]="Native"
NET$Status[which(NET$Species=="BLBH" & NET$RepeatID %in% BLBHnn)]="Introduced"
NET$Status[which(NET$Species=="CCAT" & NET$RepeatID %in% CCATnn)]="Introduced"
NET$Status[which(NET$Species=="LING" & NET$RepeatID %in% LINGnn)]="Introduced"
NET$Status[which(NET$Species=="WSU" & NET$RepeatID %in% WSUnn)]="Introduced"
NET$Status[which(NET$Species=="RMCT" & NET$RepeatID %in% RMCTnn)]="Introduced"
NET$Status[which(NET$Species=="DRUM")]="Native"
NET$Status[which(NET$Species=="DRUM" & NET$RepeatID %in% drumnn)]="Introduced"
NET$Status[which(NET$Species=="PKF")]="Native"
NET$Status[which(NET$Species=="PKF" & NET$RepeatID %in% pkfnn)]="Introduced"
NET$Status[which(NET$Species=="PTMN")]="Native"
NET$Status[which(NET$Species=="PTMN" & NET$RepeatID %in% ptmnnn)]="Introduced"
NET$Status[which(NET$Species=="BRSB")]="Native"
NET$Status[which(NET$Species=="BRSB" & NET$RepeatID %in% brsbnn)]="Introduced"
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
NET2=NET
NET=subset(NET,NET$Status=="Native"|NET$Species%in%invasive20s)
nativeSites=NET%>%
group_by(Species)%>%
summarise(sites=length(RepeatID))
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
#---------------------Net Species Changes to Only Native Populations------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
####FROM HERE, MUST RUN "DatasetPrep.R" for section
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="RMCOT" | NET$Species=="COLCOT")]="MOTCOT"
traits=read.csv("traits.csv")
traits=traits%>%rename("Species"="Code")
NET=left_join(NET,traits,by="Species")
NET$Status[which(NET$Species=="RDSH")]="Native"
NET$Status[which(NET$Species=="RDSH" & NET$RepeatID %in% rdshnn)]="Introduced"
NET$Status[which(NET$Species=="LKCH" & NET$RepeatID %in% lkchnn)]="Introduced"
NET$Status[which(NET$Species=="FHMN" & NET$RepeatID %in% FHMNnn)]="Introduced"
NET$Status[which(NET$Species=="LNDC" & NET$RepeatID %in% LNDCnn)]="Introduced"
NET$Status[which(NET$Species=="CRCH" & NET$RepeatID %in% CRCHnn)]="Introduced"
NET$Status[which(NET$Species=="BLBH")]="Native"
NET$Status[which(NET$Species=="BLBH" & NET$RepeatID %in% BLBHnn)]="Introduced"
NET$Status[which(NET$Species=="CCAT" & NET$RepeatID %in% CCATnn)]="Introduced"
NET$Status[which(NET$Species=="LING" & NET$RepeatID %in% LINGnn)]="Introduced"
NET$Status[which(NET$Species=="WSU" & NET$RepeatID %in% WSUnn)]="Introduced"
NET$Status[which(NET$Species=="RMCT" & NET$RepeatID %in% RMCTnn)]="Introduced"
NET$Status[which(NET$Species=="DRUM")]="Native"
NET$Status[which(NET$Species=="DRUM" & NET$RepeatID %in% drumnn)]="Introduced"
NET$Status[which(NET$Species=="PKF")]="Native"
NET$Status[which(NET$Species=="PKF" & NET$RepeatID %in% pkfnn)]="Introduced"
NET$Status[which(NET$Species=="PTMN")]="Native"
NET$Status[which(NET$Species=="PTMN" & NET$RepeatID %in% ptmnnn)]="Introduced"
NET$Status[which(NET$Species=="BRSB")]="Native"
NET$Status[which(NET$Species=="BRSB" & NET$RepeatID %in% brsbnn)]="Introduced"
invasive20s=c("LL","CARP","GSUN","RB","RSSH","EB","SMB","NP")
NET=subset(NET,NET$Status=="Native"|NET$Species%in%invasive20s)
nativeSites=NET%>%
group_by(Species)%>%
summarise(sites=length(RepeatID))
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
NET=left_join(NET,NET3,by="Species")
NET$EarlyNum[which(is.na(NET$EarlyNum))]=0
NET$LateNum[which(is.na(NET$LateNum))]=0
NET$propChange=NA
NET$propChange=NET$LateNum/NET$EarlyNum
NET=left_join(NET,nativeSites,by="Species")
NETl20=subset(NET,NET$sites<20)
NETsub=subset(NET,NET$sites>=20)
NETsub=subset(NETsub,NETsub$Species!="ONC" & NETsub$Species!="FMxWSU")
#=====================================================================
#============================SECTION 5: Examine Net Change for Species
#=====================================================================
#---------------------Net Species Change------------------------------------------
NET=read.csv("PersistenceMetrics.csv")
removes=read.csv("REMOVES.csv")
removes=removes[,c(1,3)]
#removes=removes%>%rename("RepetID"="RepeatID")
NET=left_join(NET,removes,by="RepeatID")
NET=subset(NET,NET$GearMiss!="Y")
NET=subset(NET, NET$F_MAUG_<1000)
NET=subset(NET, NET$RepeatID!=234 & NET$RepeatID!=74& NET$RepeatID!=237& NET$RepeatID!=238)
NET=NET%>%pivot_longer(cols = c(28:121),names_to = "Species",values_to = "change")
NET=subset(NET,!is.na(NET$change))
NET$Species[which(NET$Species=="COLCOT"|NET$Species=="RMCOT")]="MOTCOT"
NET2=NET%>%group_by(Species)%>%summarise(net=sum(change), sites=length(unique(RepeatID)))
NET3=NET%>%filter(change!=-1)%>%group_by(Species)%>%summarise(LateNum=length(change))
NET=NET%>%filter(change!=1)%>%group_by(Species)%>%summarise(EarlyNum=length(change))
NET=left_join(NET2,NET,by="Species")
NET=left_join(NET,NET3,by="Species")
NET$EarlyNum[which(is.na(NET$EarlyNum))]=0
NET$LateNum[which(is.na(NET$LateNum))]=0
NET$propChange=NA
NET$propChange=NET$LateNum/NET$EarlyNum
NET=full_join(NET,traits,by="Species")
write.csv(NET,"NET2.csv")
NETl20I=subset(NET,NET$sites<20)
View(NETl20I)
NETl20I=subset(NET,NET$sites<20 &NET$Status=="Introduced")
