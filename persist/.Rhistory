geom_point()+
geom_smooth(method = "lm")
tempgraph
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
theme_classic()
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Community Turnover")
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Community Turnover")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=length, y=pNat, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
#MODEL FOR VAR IMP
coeff=as.data.frame(ssn_modN$coefficients$fixed)
coeff$Variable=NA
coeff$Variable=rownames(coeff)
coeff=coeff%>%rename("Score"="ssn_modN$coefficients$fixed")
coeff=coeff[-1,]
coeff$Score2=NA
coeff$Score2=abs(coeff$Score)
coeff$Var2=NA
coeff$Var2[which(coeff$Variable=="scale(temp)")]="Temperature"
coeff$Var2[which(coeff$Variable=="scale(size)")]="Stream Size"
coeff$Var2[which(coeff$Variable=="scale(barrier)")]="Barriers"
coeff$Var2[which(coeff$Variable=="scale(length)")]="Fragment Length"
coeff$Var2[which(coeff$Variable=="scale(pisc)")]="Piscivores"
coeff$Var2[which(coeff$Variable=="scale(prosper)")]="Flow Permanence"
coeff$Sign=NA
coeff$Sign[which(coeff$Score>0)]="Pos"
coeff$Sign[which(coeff$Score<0)]="Neg"
VarImpNative=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="A. Green River Basin Native Species Persistence")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpNative
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = TempCat, label = TempCat))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
scale_color_viridis_b()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
scale_color_viridis_a()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
scale_color_brewer(name = "Spectral")+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point()+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp, label="Temperature"))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", se=F, color="black")+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_point(size=2)+
scale_color_viridis_c()+
geom_smooth(method = "lm", color="black")+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis_c()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis_d()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis_b()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Community Turnover")+
theme_classic()
ssn_modT <- ssn_glm(
formula =   Turnover~ scale(temp)*scale(barrier)*scale(length)*scale(prosper),
family = "beta",
ssn.object = nssn,
tailup_type = "exponential",
taildown_type = "exponential",
euclid_type = "exponential",
random = ~as.factor(YrangeCat),
spcov_type = "exponential",
additive = "afvArea"
)
T.torg=Torgegram(Turnover~ 1,ssn.object = nssn,bins = 30)
plot(T.torg)
T.torg=Torgegram(Turnover~ 1,ssn.object = nssn,bins = 5)
plot(T.torg)
T.torg=Torgegram(Turnover~ 1,ssn.object = nssn,bins = 10)
plot(T.torg)
summary(ssn_modT)
ssn_modTint <- ssn_glm(
formula =   Turnover~ scale(temp)+scale(barrier)+scale(length)+scale(prosper),
family = "beta",
ssn.object = nssn,
tailup_type = "exponential",
taildown_type = "exponential",
euclid_type = "exponential",
random = ~as.factor(YrangeCat),
spcov_type = "exponential",
additive = "afvArea"
)
summary(ssn_modT)
loocv(ssn_modTint)
glances(ssn_modT, ssn_modTint)
VarImpTurn=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="B. Green River Basin Community Turnover")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpTurn
#MODEL FOR VAR IMP
coeff=as.data.frame(ssn_modN$coefficients$fixed)
coeff$Variable=NA
coeff$Variable=rownames(coeff)
coeff=coeff%>%rename("Score"="ssn_modN$coefficients$fixed")
coeff=coeff[-1,]
coeff$Score2=NA
coeff$Score2=abs(coeff$Score)
coeff$Var2=NA
coeff$Var2[which(coeff$Variable=="scale(temp)")]="Temperature"
coeff$Var2[which(coeff$Variable=="scale(size)")]="Stream Size"
coeff$Var2[which(coeff$Variable=="scale(barrier)")]="Barriers"
coeff$Var2[which(coeff$Variable=="scale(length)")]="Fragment Length"
coeff$Var2[which(coeff$Variable=="scale(pisc)")]="Piscivores"
coeff$Var2[which(coeff$Variable=="scale(prosper)")]="Flow Permanence"
coeff$Sign=NA
coeff$Sign[which(coeff$Score>0)]="Pos"
coeff$Sign[which(coeff$Score<0)]="Neg"
VarImpNative=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="A. Green River Basin Native Species Persistence")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpNative
#full model -- max likelihood
ssn_modN <- ssn_glm(
formula =   pNat~ scale(temp)+scale(barrier)+scale(length)+scale(pisc)+scale(prosper),
family = "beta",
ssn.object = nssn,
tailup_type = "exponential",
taildown_type = "exponential",
euclid_type = "exponential",
random = ~as.factor(YrangeCat),
spcov_type = "exponential",
additive = "afvArea"
)
#MODEL FOR VAR IMP
coeff=as.data.frame(ssn_modN$coefficients$fixed)
coeff$Variable=NA
coeff$Variable=rownames(coeff)
coeff=coeff%>%rename("Score"="ssn_modN$coefficients$fixed")
coeff=coeff[-1,]
coeff$Score2=NA
coeff$Score2=abs(coeff$Score)
coeff$Var2=NA
coeff$Var2[which(coeff$Variable=="scale(temp)")]="Temperature"
coeff$Var2[which(coeff$Variable=="scale(size)")]="Stream Size"
coeff$Var2[which(coeff$Variable=="scale(barrier)")]="Barriers"
coeff$Var2[which(coeff$Variable=="scale(length)")]="Fragment Length"
coeff$Var2[which(coeff$Variable=="scale(pisc)")]="Piscivores"
coeff$Var2[which(coeff$Variable=="scale(prosper)")]="Flow Permanence"
coeff$Sign=NA
coeff$Sign[which(coeff$Score>0)]="Pos"
coeff$Sign[which(coeff$Score<0)]="Neg"
VarImpNative=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="A. Green River Basin Native Species Persistence")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpNative
ssn_modT <- ssn_glm(
formula =   Turnover~ scale(temp)+scale(barrier)+scale(length)+scale(prosper),
family = "beta",
ssn.object = nssn,
tailup_type = "exponential",
taildown_type = "exponential",
euclid_type = "exponential",
random = ~as.factor(YrangeCat),
spcov_type = "exponential",
additive = "afvArea"
)
loocv(ssn_modT)#0.202
ssn_modTint <- ssn_glm(
formula =   Turnover~ scale(temp)*scale(barrier)*scale(length)*scale(prosper),
family = "beta",
ssn.object = nssn,
tailup_type = "exponential",
taildown_type = "exponential",
euclid_type = "exponential",
random = ~as.factor(YrangeCat),
spcov_type = "exponential",
additive = "afvArea"
)
loocv(ssn_modTint)#0.202
#MODEL FOR VAR IMP
coeff=as.data.frame(ssn_modT$coefficients$fixed)
coeff$Variable=NA
coeff$Variable=rownames(coeff)
coeff=coeff%>%rename("Score"="ssn_modT$coefficients$fixed")
coeff=coeff[-1,]
coeff$Score2=NA
coeff$Score2=abs(coeff$Score)
coeff$Var2=NA
coeff$Var2[which(coeff$Variable=="scale(temp)")]="Temperature**"
coeff$Var2[which(coeff$Variable=="scale(size)")]="Stream Size"
coeff$Var2[which(coeff$Variable=="scale(barrier)")]="Barriers**"
coeff$Var2[which(coeff$Variable=="scale(length)")]="Fragment Length**"
coeff$Var2[which(coeff$Variable=="scale(prosper)")]="Flow Permanence"
coeff$Sign=NA
coeff$Sign[which(coeff$Score>0)]="Pos"
coeff$Sign[which(coeff$Score<0)]="Neg"
VarImpTurn=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="B. Green River Basin Community Turnover")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpTurn
#MODEL FOR VAR IMP
coeff=as.data.frame(ssn_modT$coefficients$fixed)
coeff$Variable=NA
coeff$Variable=rownames(coeff)
coeff=coeff%>%rename("Score"="ssn_modT$coefficients$fixed")
coeff=coeff[-1,]
coeff$Score2=NA
coeff$Score2=abs(coeff$Score)
coeff$Var2=NA
coeff$Var2[which(coeff$Variable=="scale(temp)")]="Temperature"
coeff$Var2[which(coeff$Variable=="scale(size)")]="Stream Size"
coeff$Var2[which(coeff$Variable=="scale(barrier)")]="Barriers**"
coeff$Var2[which(coeff$Variable=="scale(length)")]="Fragment Length**"
coeff$Var2[which(coeff$Variable=="scale(prosper)")]="Flow Permanence"
coeff$Sign=NA
coeff$Sign[which(coeff$Score>0)]="Pos"
coeff$Sign[which(coeff$Score<0)]="Neg"
VarImpTurn=coeff%>%arrange(Score2) %>%
mutate(Var2=factor(Var2, levels=Var2)) %>%
ggplot(aes(x=Var2, y=Score2, colour = Sign)) +
geom_segment( aes(xend=Var2, y=0,yend=Score2)) +
geom_point(size=4) +
theme_light() +
scale_color_manual(values = c("#ff9999","#018080"))+
theme(
panel.grid.major.x = element_blank(),
panel.border = element_blank(),
axis.ticks.x = element_blank(),
axis.text = element_text(size=10, color = "black"),
legend.position = "none"
) +
ggtitle(label="B. Green River Basin Community Turnover")+
xlab("") +
coord_flip() +
ylab("Variable Importance")
VarImpTurn
hist(nssn$obs$length)
quantile(nssn$obs$length)
nssn$obs$FragCat=NA
nssn$obs$FragCat[which(nssn$obs$length<46.7)]="Smaller (<46.7 km)"#180
nssn$obs$FragCat[which(nssn$obs$length>=46.7)]="Large (>46.7 km)" #177
nssn$obs%>%group_by(FragCat)%>%summarise(n=length(temp))
quantile(nssn$obs$temp)
nssn$obs$TempCat=NA
nssn$obs$TempCat[which(nssn$obs$temp<20)]="Cold (<20 C)" #261
nssn$obs$TempCat[which(nssn$obs$temp>=20)]="Warm (>20 C)" #96
nssn$obs%>%group_by(TempCat)%>%summarise(n=length(temp))
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Community Turnover")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis_b()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
###
nssn$obs%>%
ggplot(aes(x=length, y=Turnover, color = as.factor(barrier), label = as.factor(barrier)))+
geom_point()+
xlab(label="Stream Fragment Length (km)")+
geom_smooth(method = "lm", se=F)+
ggtitle(label="Community Turnover")+
theme_classic()
nssn$obs%>%
ggplot(aes(x=prosper, y=pNat*100, color = temp))+
geom_smooth(method = "lm", color="black")+
geom_point(size=2)+
scale_color_viridis_b()+
ylab(label = "% of Species Persisting")+
xlab(label = "Probability of Streamflow Permanence")+
ggtitle(label="Native Species Persistence")+
theme_classic()
